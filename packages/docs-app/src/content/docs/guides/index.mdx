---
title: 快速开始
descripttopn:
sidebar:
  order: 1
---

import { Tabs, TabItem, FileTree, CardGrid, LinkCard, Steps, Code } from '@astrojs/starlight/components';
import EditorSourceCode from '../../../codeSnippets/Editor.tsx?raw';
import cssSourceCode from '../../../codeSnippets/index.css?raw';
import engImg from '../../../assets/engine-thumbail.png';

## 安装

<Tabs>
  <TabItem label="npm">```shell npm i @chamn/engine @chamn/model @chamn/render ```</TabItem>
  <TabItem label="pnpm">```shell pnpm i @chamn/engine @chamn/model @chamn/render ```</TabItem>
  <TabItem label="yarn">```shell yarn i @chamn/engine @chamn/model @chamn/render ```</TabItem>
</Tabs>

你可以在你的机器上的任何地方运行 `create astro`，因此在开始之前无需创建一个新的空目录。如果你还没有为你的新项目准备一个空目录，向导将会自动为你创建一个。

如果一切顺利，你将看到一个成功信息，随后是一些推荐的后续步骤。现在你的项目已经创建好了，你可以 `cd` 进入你的新项目目录开始使用 Astro。

由于演示用例使用了 `antd` 以及 `@chamn/demo-page` 库(这不是必须的，只是这里做演示使用)，所以你还需要安装：

<Tabs>
  <TabItem label="npm">```shell npm i antd @ant-design/icons @chamn/demo-page ```</TabItem>
  <TabItem label="pnpm">```shell pnpm i antd @ant-design/icons @chamn/demo-page ```</TabItem>
  <TabItem label="yarn">```shell yarn i antd @ant-design/icons @chamn/demo-page ```</TabItem>
</Tabs>

## 用法

创建一个 Editor.tsx 文件，将以下代码拷贝进去:

<Code code={EditorSourceCode} lang="tsx" title="Editor.tsx" />

添加 css 让编辑器撑满窗口

<Code code={cssSourceCode} lang="css" title="index.css" />

## 配置 render.umd.js

因为渲染画布是在 iframe 中运行，所以需使用 umd 模式的 js，然后让 iframe 加载。在 vite 构建工具下，有以下三种配置方式：

### 方式一：使用 `?url` 后缀导入（推荐）

这是最简单的方式，直接使用 vite 的 `?url` 后缀导入文件 URL，无需额外配置：

```tsx
import renderAsURL from '@chamn/render/dist/index.umd.js?url';

<Engine
  plugins={DEFAULT_PLUGIN_LIST}
  schema={page}
  material={[...InnerComponentMeta, ...Material]}
  assetPackagesList={assetPackagesList}
  onReady={onReady}
  renderJSUrl={renderAsURL}
/>;
```

或者从 node_modules 路径导入：

```tsx
import renderAsURL from '../../node_modules/@chamn/render/dist/index.umd.js?url';
```

### 方式二：使用 vite-plugin-static-copy 插件

使用 `vite-plugin-static-copy` 插件在构建时自动将文件拷贝到输出目录：

首先安装依赖：

<Tabs>
  <TabItem label="npm">```shell npm i vite-plugin-static-copy ```</TabItem>
  <TabItem label="pnpm">```shell pnpm i vite-plugin-static-copy ```</TabItem>
  <TabItem label="yarn">```shell yarn i vite-plugin-static-copy ```</TabItem>
</Tabs>

然后在 `vite.config.ts` 中配置：

```ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import monacoEditorPlugin from 'vite-plugin-monaco-editor';
import { viteStaticCopy } from 'vite-plugin-static-copy';

export default defineConfig({
  plugins: [
    react(),
    monacoEditorPlugin({}),
    viteStaticCopy({
      targets: [
        {
          src: './node_modules/@chamn/render/dist/index.umd.js',
          dest: './',
          rename: 'render.umd.js',
        },
      ],
    }),
  ],
});
```

这样构建时会自动将 `render.umd.js` 拷贝到输出目录的根目录下，然后使用相对路径：

```tsx
<Engine
  plugins={DEFAULT_PLUGIN_LIST}
  schema={page}
  material={[...InnerComponentMeta, ...Material]}
  assetPackagesList={assetPackagesList}
  onReady={onReady}
  renderJSUrl="./render.umd.js"
/>
```

### 方式三：使用 CDN 或自定义路径

如果使用 CDN 或其他自定义路径，可以直接传入 URL：

```tsx
<Engine
  plugins={DEFAULT_PLUGIN_LIST}
  schema={page}
  material={[...InnerComponentMeta, ...Material]}
  assetPackagesList={assetPackagesList}
  onReady={onReady}
  renderJSUrl="https://cdn.example.com/render.umd.js"
/>
```

或者使用相对路径：

```tsx
<Engine
  plugins={DEFAULT_PLUGIN_LIST}
  schema={page}
  material={[...InnerComponentMeta, ...Material]}
  assetPackagesList={assetPackagesList}
  onReady={onReady}
  renderJSUrl="./public/render.umd.js"
/>
```

## 配置 monaco-editor 构建

因为引擎使用了 monaco-editor 代码编辑器所以需要配置相应的构建配置

### Vite

```ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import monacoEditorPlugin from 'vite-plugin-monaco-editor';

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react(), monacoEditorPlugin({})],
});
```

### Webpack

[Refenrence](https://www.npmjs.com/package/monaco-editor-webpack-plugin)

## 运行

将 Editor.tsx 页面作为你项目中的一个页面，运行，打开对应的地址你将会得到一个编辑页面

<img src={engImg.src} style={{ marginBottom: '20px', border: '1px solid #ededed' }} alt="Engine thumbail" />

:::info
Good Luck! :)
:::
